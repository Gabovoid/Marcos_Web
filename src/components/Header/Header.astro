---
import { Image } from "astro:assets";
import logo from "../../assets/Logo.png";
import CartWidget from "../Carts/PanelCart";
import AuthButton from "../Auth/AuthButton";
---

<header class="bg-black text-white flex items-center justify-between border-b border-white px-4 sm:px-8 py-5 fixed top-0 left-0 right-0 z-50">
  <!-- logo -->
  <a href="/" class="flex items-center space-x-2 flex-shrink-0">
    <Image
      src={logo}
      alt="logo"
      class="h-10 w-10"
      format="png"/>
    <p class="text-xl sm:text-2xl font-bold tracking-widest">VINYL VOID</p>
  </a>

  <!-- nav-->
  <nav class="hidden lg:block text-1xl">
    <ul class="flex space-x-5 font-semibold">
      <li><a href="/" class="hover:text-gray-400">INICIO</a></li>
      <li><a href="/productos" class="hover:text-gray-400">PRODUCTOS</a></li>
      <li><a href="/about" class="hover:text-gray-400">NOSOTROS</a></li>
      <li><a href="/contact" class="hover:text-gray-400">CONTÁCTANOS</a></li>
    </ul>
  </nav>

  <!--botones-->
  <div class="flex items-center space-x-2 sm:space-x-1 md:space-x-4">
    <!-- Buscador Desktop -->
    <form id="search-form-desktop" action="/busqueda" method="get" class="hidden lg:flex items-center border-b border-white w-40 sm:w-56 space-x-2">
      <input
        type="text"
        name="q"
        id="search-input-desktop"
        placeholder="Buscar..."
        class="bg-transparent text-white placeholder-gray-400 focus:outline-none w-full px-2"/>
      <button type="submit" class="rounded-full p-3 sm:p-2 cursor-pointer hover:bg-white hover:text-black transition">
        <!--lupa -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 stroke-[2]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/>
        </svg>
      </button>
    </form>

    <!-- Usuario -->
    <AuthButton client:load />

    <!-- carrito -->
    <CartWidget client:load />

    <!-- Botón hamburguesa -->
    <button id="menu-toggle" class="lg:hidden text-2xl focus:outline-none rounded-full p-3 sm:p-2 cursor-pointer hover:bg-white hover:text-black transition">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>
  </div>
</header>

<!-- sub-menu fono (oculto por defecto) -->
<nav
  id="submenu"
  class="hidden fixed top-0 left-0 w-full h-full bg-black/95 flex-col space-y-3 px-8 pt-24 pb-6 z-40 lg:hidden text-xl font-semibold transition-all duration-300 ease-in-out">
  
  <div class="flex flex-col space-y-4 py-5">
    <a href="/" class="text-white hover:text-gray-400">INICIO</a>
    <a href="/productos" class="text-white hover:text-gray-400">PRODUCTOS</a>
    <a href="/about" class="text-white hover:text-gray-400">NOSOTROS</a>
    <a href="/contact" class="text-white hover:text-gray-400">CONTÁCTANOS</a>
  </div>

  <div class="h-0.5 bg-white -mx-8"></div>
  
  <!-- Buscador Mobile -->
  <form id="search-form-mobile" action="/busqueda" method="get" class="flex items-center border-b border-white w-full">
    <input
      type="text"
      name="q"
      id="search-input-mobile"
      placeholder="Buscar..."
      class="bg-transparent text-white placeholder-gray-400 focus:outline-none w-full px-2"/>
    <button type="submit" class="border-white rounded-full py-5 cursor-pointer hover:bg-white hover:text-black transition">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" 
           viewBox="0 0 24 24" fill="none" stroke="currentColor" 
           stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m21 21-4.34-4.34"></path>
        <circle cx="11" cy="11" r="8"></circle>
      </svg>
    </button>
  </form>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleBtn = document.getElementById("menu-toggle");
    const submenu = document.getElementById("submenu");

    // Toggle del menú móvil
    toggleBtn?.addEventListener("click", () => {
      submenu?.classList.toggle("hidden");
      submenu?.classList.toggle("flex");
    });

    // Manejo del formulario de búsqueda desktop
    const searchFormDesktop = document.getElementById("search-form-desktop");
    searchFormDesktop?.addEventListener("submit", (e) => {
      const input = document.getElementById("search-input-desktop") as HTMLInputElement;
      if (!input.value.trim()) {
        e.preventDefault();
        alert("Por favor ingresa un término de búsqueda");
      }
    });

    // Manejo del formulario de búsqueda mobile
    const searchFormMobile = document.getElementById("search-form-mobile");
    searchFormMobile?.addEventListener("submit", (e) => {
      const input = document.getElementById("search-input-mobile") as HTMLInputElement;
      if (!input.value.trim()) {
        e.preventDefault();
        alert("Por favor ingresa un término de búsqueda");
      }
    });
  });
</script>